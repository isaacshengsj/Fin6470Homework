---
title: "Fin 6470 Midterm"
output:
  html_document: default
  html_notebook: default
---
####Question 1

#####a. 
For the formular $F_{0}=S_{0}e^{rT}$ is the future value of the spot time at time T. When $F_{0}>S_{0}e^{rT}$, this implies the future price is higher than the future value of the spot price, which is overvalued. There is a potential risk-free arbitrage opportunity for trading in. The trading strategy for this risk-free arbitrage is to buy or borrow $S_{0}$ and sell $F_{0}$ at time 0. Deliver the future contract at time T.

####b. 
For $F_{0}<S_{0}e^{rT}$, this also implies potential risk-free arbitrage opportunity. The future price is undervalued at time 0. With the idea of arbitrage, investor can do buy low sell high to get spread in this risk-free transaction.

####c.
The dividend payment will not deliver with the future contract and the value of either discrete dividend or continuous divident payment will be hold by issuer. So we should subtract the value of dividend when pricing the price of future option. For discrete payment, the function will be 
$$F_{0,T}=S_{0}e^{rT}-\sum_{i=1}^{n}e^{r(T-t_{i})}*Div_{t,i}$$
For the continuous dividend, the function will be:
$$F_{0,T}=S_{0}e^{rT}*e^{-\delta*T} \to F_{0,T}=S_{0}e^{(r-\delta)T}$$

####d.
Producers will store more material than actual production need to prevent the loss due to run out of material. When borrower borrow the excee material, borrower will pay $\delta=\lambda-c$. $\lambda$ is the cost ratio for storage, $c$ is the convenience yield. For lender, will save $\lambda-c$. The function will be:
$$F_{0}=S_{0}e^{(r-\delta+c)T}$$

####e. 
$F_{T}=S_{T}$ This is the unbiased expectation of the future price of the actual asset. Under the equilibrium, we can change the functon into $F_{T}=E(S_{T})$, which is the expect future price. The price of market is effecient. Price can reflect the supply and demand of the market. With this rule, people is expected to break even when the futures market fairly prices the deliverable commodity.
$F_{T} \ne S_{T}$ This means the supply and demand are not balanced. Under this situation for physical delivery of the contract, there will be risk for default because of the unbalance of supply and demand.

####f.
The prepaid forward contract will let investors pay the price up front and the issuers will deliver in the future. But during the contract time, investors doesn't hold the dividend and thy are going to pay at $time=0$. The function will be: $F_{0,T}=S_{0}-PV_{0,T}(Dividend)$. Prepaid future contract can help to lock in the cash and this is the biggest reason to trade prepaid forward contract. This can turn either stock or bond into liquid cash and maintaining the ability to make even more money if the shares rise in value. For investors, they profit from the stock while maintaining the leverage of ownership and voting power. Prepaid forward contract actually exists in the real world. There are a lot of highly paid corporate employees, billionaire businessmen and investors will use prepaid forward contracts to lock in their gains. Call option and put option is also one of the prepaid forward contract.

###Question 2

```{r}
dairy <- read_csv("C:/Users/Isaacsheng/Downloads/dairy.csv")
summary(dairy)
```
#Augmented Dickey Fuller test for DL
```{r}
library(urca)
adf.dl <- ur.df(y=dairy$DL.Nearest.Settlement, type = "drift", selectlags = "BIC")
summary(adf.dl)
plot(adf.dl)
```
There is no unit root in this test.
#Augmented Dickey Fuller test for diff DL
```{r}
diff.dl<-diff(dairy$DL.Nearest.Settlement)
adf.diffdl<-ur.df(y=diff.dl, type="drift", selectlags = "BIC")
summary(adf.diffdl)
plot(adf.diffdl)
```
There is a unit root which is z.lag.1. The t-value is 10.968 which we cannot reject.
#Augmented Dickey Fuller test for BJ
```{r}
adf.bj <- ur.df(y=dairy$BJ.Nearest.Settlement, type = "drift", selectlags = "BIC")
summary(adf.bj)
plot(adf.bj)
```
There is no unit root in this test.

#Augmented DIckey Fuller test for diff BJ
```{r}
diff.bj<-diff(dairy$BJ.Nearest.Settlement)
adf.diffbj<-ur.df(y=diff.bj, type="drift", selectlags = "BIC")
summary(adf.diffbj)
plot(adf.diffbj)
```
There is an unit root which is z.lag.1. The t-value is 11.209 suggests that we cannot reject.
#Augmented Dickey Fuller test for ln DL
```{r}
ln.dl<-log(dairy$DL.Nearest.Settlement)
adf.lndl<-ur.df(ln.dl, type="drift", selectlags= "BIC")
summary(adf.lndl)
plot(adf.lndl)
```
There is no unit root in this test.

#Augmented Dickey Fuller test for diff ln DL
```{r}
diff.lndl<-diff(ln.dl)
adf.lndiffdl<-ur.df(diff.lndl, type="drift", selectlags = "BIC")
summary(adf.lndiffdl)
plot(adf.lndiffdl)
?ur.df
```
There is an unit root in this test z.lag.1 and the t-value is -10.983 suggests that we cannot reject.

#Augmented Dickey Fuller test for ln BJ
```{r}
ln.bj<-log(dairy$BJ.Nearest.Settlement)
adf.lnbj<-ur.df(ln.bj, type = "drift", selectlags = "BIC")
summary(adf.lnbj)
plot(adf.lnbj)
```
There is no unit root in this test.

#Augmented Dickey Fuller test for diff ln BJ
```{r}
diff.lnbj<-diff(ln.bj)
adf.lndiffbj<-ur.df(diff.lnbj, type = "drift", selectlags = "BIC")
summary(adf.lndiffbj)
plot(adf.lndiffbj)
```
There is an unit root in the test z.lag.1. The t-value is -11.190 suggests that we cannot reject.
For both of Class III milk and cheese, the unit root exists in price difference and log-price difference. The price difference and log-price difference are nonstationary. But the price and log-price are stationary. This result suprised me because my original idea was both price and difference of price are stationary.

```{r}
dl <- (dairy$DL.Nearest.Settlement)
bj <- (dairy$BJ.Nearest.Settlement)
reg <- lm(bj~dl)
summary(reg)
resid <- reg$residuals
plot(resid, type = "b", lwd = 3, col = "blue", main = "Engle-Granger Step 1 Residuals")
```
Log price Engle-Granger First step:
```{r}
regln<-lm(ln.bj~ln.dl)
summary(regln)
residln<- regln$residuals
plot(residln, type = "b", lwd = 3, col = "blue", main = "Engle-Granger Step 1 Residuals")
```

```{r}
adf.residln <- ur.df(residln, type ="drift", selectlags = "BIC")
summary(adf.residln)
```
#### Minimum Variance Hedge
```{r}
vol.bj <- sd(ln.bj)
vol.dl <- sd(ln.dl)
rho <- cor(ln.dl,ln.bj)
h.star<-rho*(vol.dl/vol.bj)
h.star
regmv <- lm(diff.lndl~diff.lnbj)
summary(regmv)
```
From the result, the minimum variance hedge ratio is 1.217658

### Question 3
a. 
Heating Oil spot
```{r}
alpha.oil = 0.342
beta.oil = 0.539
sigma.oil = .11
S.oil.0 = 0.69
nreps = 45

ln.spot.oil <- rep(0, nreps)
ln.spot.oil[1] <- log(S.oil.0)

z1 <- rnorm(nreps)

for(t in 2:nreps)
{
  ln.spot.oil[t] <- ln.spot.oil[t-1] + alpha.oil * (beta.oil - exp(ln.spot.oil[t-1])) + z1[t] * sigma.oil
}

plot(ln.spot.oil, lwd=2 , type="l")
```
Gasoline spot
```{r}
alpha.gas = 0.391
beta.gas = 0.560
sigma.gas = .116
S.gas.0 = 0.80
nreps = 45

ln.spot.gas <- rep(0, nreps)
ln.spot.gas[1] <- log(S.gas.0)

z1 <- rnorm(nreps)

for(t in 2:nreps)
{
  ln.spot.gas[t] <- ln.spot.gas[t-1] + alpha.gas * (beta.gas - exp(ln.spot.gas[t-1])) + z1[t] * sigma.gas
}

plot(ln.spot.gas, lwd=2 , type="l")
lines(ln.spot.oil, type="l", col="red")

```


Heating Oli future
```{r}
alpha.boil = 0.663
beta.boil = -0.009
sigma.boil = 0.025
S.boil.0 = -0.02
nreps = 45
z1 <- rnorm(nreps)
b.oil<-rep(0,nreps)
for(t in 2:nreps)
{
  b.oil[t]=alpha.boil*b.oil[t-1]+beta.boil*exp(ln.spot.oil[t-1])+z1[t]*sigma.boil
}



future.oil <- rep(0,nreps)

for(t in 1:nreps)
{
  future.oil[t] <- exp(ln.spot.oil[t])*exp(b.oil[t])
}

plot(future.oil, lwd=2 , type="l")

```
Gasoline future
```{r}
alpha.bgas = 0.424
beta.bgas = -0.015
sigma.bgas = 0.029
S.bgas.0 = -0.01
nreps = 45
z1 <- rnorm(nreps)
b.gas<-rep(0,nreps)
for(t in 2:nreps)
{
  b.gas[t]=alpha.bgas*b.gas[t-1]+beta.bgas*exp(ln.spot.gas[t-1])+z1[t]*sigma.bgas
}



future.gas <- rep(0,nreps)

for(t in 1:nreps)
{
  future.gas[t] <- exp(ln.spot.gas[t])*exp(b.gas[t])
}

plot(future.gas, lwd=2 , type="l", xlab = "Days", ylab = "Future prices")
lines(future.oil, type="l", col="red")
lines(b.gas, type="l", col="blue")
```

b.The plots have already in question a.
#### Minimum Variance Hedging
```{r}
vol.oil.s<-sd(ln.spot.oil)
vol.oil.f<-sd(log(future.oil))
rho.oil<-cor(ln.spot.oil,log(future.oil))
h.star.oil<- rho.oil*(vol.oil.s/vol.oil.f)
h.star.oil
```
The minimum variance hedging ration for heating oil is 0.8470727.

```{r}
vol.gas.s<-sd(ln.spot.gas)
vol.gas.f<-sd(log(future.gas))
rho.gas<-cor(ln.spot.gas, log(future.gas))
h.star.gas<-rho.gas*(vol.gas.s/vol.gas.f)
h.star.gas
```
The minimum variance hedging ratio for gasoline is 0.3686572.

#### Question 4
Forward contract is an agreement between parties to buy and sell the underlying asset at a specified date and agreed rate in the future. It's a private agreements between two parties. Future contracts are exchange-trades and are standardized contraccts. Forward and futures prices are very similar. The theoretical difference arises from uncertainty about the interest on mark-to-market proceeds. For short-lived contracts, the effect is generally small. However, for long-lived contracts, the difference can be significant, especially for long-lived interest rate futures, for which there is sure to be a correlation between the interest rate and the price of the underlying asset. 

Around 1750 BC, the Code of Hammurabi allowed sales of goods and assets to be delivered for an agreed price, at a future date; required contracts to be in writting and witnessed; and allowed assignment of contracts. In the early 19th century, Chicago is a natural centrer for transporattion, distributuoin, and trading agricultural rpoduce due to the geographical position. Shortagtes of products caused chaotic fluctuations in price and leads people to trad in "to arrive" or "cash forward" contracts to insulate them from the risk of price change to hedge. CME was first founded in 1874 and changed name to CME in 1919. In 1970s allowed trading in the future value of interest rates. 

From the historicl development of futures contract, people in order to lock in the price upfront and avoid the fulctuation of price change, build the futures market. But the futures market was only trade actual products. With the development of stocks, stocks starts to traded in futures market, which extended the type of commodity that traded in futures market. In order to regulate the market and avoid default risk, there are institutions were established like CME. 

With the development of futures market, people are allowed to trade with money and product in different time. People don't need to pay and get the product immediately. Futures market helps producer lock in the revenue or cost of products during producing activity.

#### Question 5
a. 
The emperical finding of this paper is the hog, corn, and soybean meal futures price are cointegrated. There are significant tendencies for the hog spread to revent to its long-run equilibrium. The market expectations as reflected in the futures term structure cannot fully incorporate the mean reversion, and that there exists a certain level of inefficiency in three futures markets. The ground rule of trading strategies is to long (short) the hog spread by buying (selling) lean hog futures and selling (buying) corn and soybean meal futures when the spread is below (above) the long-run equilibrium by a certain level.

The method that they are using is the time series of unit root test and autoregressive multivariate cointegration models and error correction models. 
From the data that the author provided and the model they use, I think the result is pursuvasive because there is strong relationship among hog, corn, and soybean meal during the production activity. Hog raisers feed hog with soybean meal and corn, and sell the hog when hog grows up. From the paper, the author has already proofed with statistical method on future price that the future price of the hog, corn, and soybean meal future price are cointegrated. Hog raisers need to buy corn and soybean meal to feed the hog. But the cost will be volital with the price of soybean meal and corn change. 

b. 
At the beginning of Liu's reserach, the author has observed there is a relationship between hog, cor, and soybean meal. In order to find the exact relationship between them, Liu should assume the market is efficient. Under the circumstance of market efficiency, Liu will be easily to set up the assumption based on common knwoledge and can also get the economic findings. For example, under the market efficiency, the price can reflect the production of corn and soybean meal. The price of corn and soybean meal directly influence the price of lean hog. In addition, market efficiency reflects the information from the market. These information will cause the volatility of the price. Sometimes we should hold the factor that will cause abnormal volatility to find what is the systematic rule. 

c.
The idea of trading strategy is based on the cointegration of these three commodity. These can guide hog raisers to trade not just hog but also lock in the price for commodities to raise hog. Then the hog raisers can protect themselves from the profit decrease with the price volatility. I think this simulation is convincing because this simulation based on the statistical relationship and the financial hedging strategy. I would not put actual money on this because I need to figure out the information on the back of price change of soybean meal and the corn. Maybe the price change of soybean meal and corn is because the weather is abnormal or natural disaster. Maybe because of the amount of people that grow these commodities significantly change. I think the trading strategy would be more complete if I can figure out what situations leads the price change of three commodities instead of just expose the relationship between those three commodities.

#### Question 6
a. 
The synthetic hedging strategy is to hedge long-dated obligations with short-dated futures. On the first delivery date, the firm buys in the spot market for delivery, offsets all its maturing futures contracts, and re-establishes a long position in the new front-month futures contract, with its long future positionsd reduced by the amount delivered on its flow on contracts. On the next settlement date, the hedger again decrease the size of its futures position by the amount delivered and rolls the rest forward to the next maturing one-month futures contract. And so on, month by month. Firm use derivatives to hedge is to reduce the expected cost of financial distress or reduce the variability of their net cash flows. The motive of MG's is to maximize the value. With the superior information about price relations with respect to spot prices, MG's are trading the basis with out exposing itself to spot price risk. Risk minimize is to manage the risk of position under the asymmetric information. With the asymmetric information, companies will need to minimize the risk to prevent the price volatility because of the asymmetric information. Minimize risk may also cost more to sucessfully hedge the risk, which means the value will be shrinked down.

b. 

c. 
Pirrong thinks the MG's prediction of oil prices leads the great loss. The goal for MG's strategy is to maximizing value based on the superior information and the proper prediction on prices. Bayes rule can completely help MG's found the wrong prediction of the price but MG's still made mistake on that. 

d.
In the situation of contango, which is the futures price is above the expected future spot price, MG's will lose money when they keep the same hedge strategy. This will suggests MG's has a proepr hedge strategy to hedge this kind of situation.

#### Question 7
Is sound just noise?: This paper proofed sound level conveys information which is highly economically and statistically significant. In Coval & shumway's paper, They found increased sound levels are highly significant in forecasting increased price volatility several minutes into the future. What's more, with the statistical data in this paper, it also proved the significant relationshi, trading volumes, or news announcements.
I think both of these two paper support the main idea from Hayek. 







